server:
  port: 8080

spring:
  application:
    name: policy-query-service
  kafka:
    bootstrap-servers: localhost:29092
    consumer:
      group-id: policy-query-service
      auto-offset-reset: earliest
      enable-auto-commit: false
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      max-poll-records: 50
    listener:
      ack-mode: manual

  data:
    elasticsearch:
      cluster-name: docker-cluster
      cluster-nodes: localhost:9300

  elasticsearch:
    uris: http://localhost:9200

# Externalized config (ConfigurationProperties)
policy-query:
  kafka:
    topic: policy-events
    dlq-topic: policy-events-dlq
  elasticsearch:
    index-prefix: policy-history
  pagination:
    default-size: 20
    max-size: 100

# Observability
management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus,metrics
  endpoint:
    health:
      show-details: when-authorized
  metrics:
    export:
      prometheus:
        enabled: true

# Zipkin (optional; set if Zipkin server is running)
# management:
#   tracing:
#     sampling:
#       probability: 1.0
# zipkin:
#   base-url: http://localhost:9411

# Resilience4j retry for indexing
resilience4j:
  retry:
    instances:
      indexPolicyEvent:
        max-attempts: 3
        wait-duration: 500ms
        enable-exponential-backoff: true
        exponential-backoff-multiplier: 2
